(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73470a1d"],{"3b0d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("商品管理")]),a("el-breadcrumb-item",[t._v("参数列表")])],1),a("el-card",[a("el-alert",{attrs:{title:"注意：只允许为第三级分类设置参数！",type:"warning",closable:!1,"show-icon":""}}),a("el-row",[a("span",[t._v("选择商品分类：")]),a("el-cascader",{attrs:{options:t.cateList,props:t.defaultProps},on:{change:t.handleCateChange},model:{value:t.currentCateIds,callback:function(e){t.currentCateIds=e},expression:"currentCateIds"}})],1),a("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"动态参数",name:"many"}},[a("el-button",{attrs:{type:"primary",size:"mini",disabled:t.isDisabled},on:{click:function(e){t.addDialogVisible=!0}}},[t._v("添加参数")]),a("el-table",{attrs:{data:t.manyList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.attr_vals,(function(n,r){return a("el-tag",{key:r,attrs:{closable:""},on:{close:function(a){return t.deleteTag(e.row,r)}}},[t._v(t._s(n))])})),e.row.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(a){return t.handleInputConfirm(e.row)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.target.blur()}},model:{value:e.row.inputValue,callback:function(a){t.$set(e.row,"inputValue","string"===typeof a?a.trim():a)},expression:"scope.row.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){return t.showInput(e.row)}}},[t._v("+ New Tag")])]}}])}),a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return t.showEditDialog(e.row.attr_id)}}},[t._v("修改")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return t.deleteAttr(e.row.attr_id)}}},[t._v("删除")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"静态属性",name:"only"}},[a("el-button",{attrs:{type:"primary",size:"mini",disabled:t.isDisabled},on:{click:function(e){t.addDialogVisible=!0}}},[t._v("添加属性")]),a("el-table",{attrs:{data:t.onlyList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.attr_vals,(function(n,r){return a("el-tag",{key:r,attrs:{closable:""},on:{close:function(a){return t.deleteTag(e.row,r)}}},[t._v(t._s(n))])})),e.row.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(a){return t.handleInputConfirm(e.row)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.target.blur()}},model:{value:e.row.inputValue,callback:function(a){t.$set(e.row,"inputValue","string"===typeof a?a.trim():a)},expression:"scope.row.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){return t.showInput(e.row)}}},[t._v("+ New Tag")])]}}])}),a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return t.showEditDialog(e.row.attr_id)}}},[t._v("修改")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return t.deleteAttr(e.row.attr_id)}}},[t._v("删除")])]}}])})],1)],1)],1)],1),a("el-dialog",{attrs:{title:"添加"+t.titleText,visible:t.addDialogVisible,width:"30%"},on:{"update:visible":function(e){t.addDialogVisible=e}}},[a("el-form",{ref:"addFormRef",attrs:{model:t.newAttr,"label-width":"100px"}},[a("el-form-item",{attrs:{label:t.titleText+"名称"}},[a("el-input",{model:{value:t.newAttr.attr_name,callback:function(e){t.$set(t.newAttr,"attr_name",e)},expression:"newAttr.attr_name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addAttr}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改"+t.titleText,visible:t.editDialogVisible,width:"30%"},on:{"update:visible":function(e){t.editDialogVisible=e}}},[a("el-form",{ref:"addFormRef",attrs:{model:t.editAttrData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:t.titleText+"名称"}},[a("el-input",{model:{value:t.editAttrData.attr_name,callback:function(e){t.$set(t.editAttrData,"attr_name",e)},expression:"editAttrData.attr_name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.editAttr}},[t._v("修 改")])],1)],1)],1)},r=[],i=a("1da1"),s=(a("159b"),a("ac1f"),a("1276"),a("a15b"),a("a434"),a("96cf"),a("de5d")),l={name:"Params",data:function(){return{cateList:[],manyList:[],onlyList:[],defaultProps:{expandTrigger:"hover",label:"cat_name",value:"cat_id"},currentCateIds:[],activeName:"many",addDialogVisible:!1,editDialogVisible:!1,newAttr:{attr_name:""},editAttrData:{}}},computed:{cateId:function(){return 3===this.currentCateIds.length?this.currentCateIds[2]:null},isDisabled:function(){return 3!==this.currentCateIds.length},titleText:function(){return"many"===this.activeName?"动态参数":"静态属性"}},created:function(){this.getCateList()},methods:{getCateList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["j"])({});case 2:a=e.sent,n=a.data,200!==n.meta.status?t.$msg.error(n.meta.msg):t.cateList=n.data;case 5:case"end":return e.stop()}}),e)})))()},getAttributes:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(3===t.currentCateIds.length){e.next=6;break}return t.currentCateIds=[],t.manyList=[],t.onlyList=[],t.$msg.error("请选择三级分类！"),e.abrupt("return");case 6:return e.next=8,Object(s["i"])(t.cateId,t.activeName);case 8:a=e.sent,n=a.data,200!==n.meta.status?t.$msg.error(n.meta.msg):(n.data.forEach((function(t){t.attr_vals=t.attr_vals?t.attr_vals.split(" "):[],t.inputVisible=!1,t.inputValue=""})),"many"===t.activeName?t.manyList=n.data:t.onlyList=n.data);case 11:case"end":return e.stop()}}),e)})))()},handleCateChange:function(){this.getAttributes()},handleTabClick:function(){this.getAttributes()},addAttr:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["a"])(t.cateId,t.newAttr.attr_name,t.activeName);case 2:a=e.sent,n=a.data,console.log(n),201!==n.meta.status?t.$msg.error(n.meta.msg):(t.$msg.success("添加成功！"),t.getAttributes(),t.addDialogVisible=!1);case 6:case"end":return e.stop()}}),e)})))()},showEditDialog:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["l"])(e.cateId,t);case 2:n=a.sent,r=n.data,200!==r.meta.status?e.$msg.error(r.meta.msg):(e.editAttrData=r.data,e.editDialogVisible=!0);case 5:case"end":return a.stop()}}),a)})))()},editAttr:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["g"])(t.cateId,t.editAttrData.attr_id,t.editAttrData.attr_name,t.activeName);case 2:a=e.sent,n=a.data,200!==n.meta.status?t.$msg.error(n.meta.msg):(t.$msg.success("修改成功！"),t.getAttributes(),t.editDialogVisible=!1);case 5:case"end":return e.stop()}}),e)})))()},deleteAttr:function(t){var e=this;this.$confirm("是否删除此参数？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["d"])(e.cateId,t);case 2:n=a.sent,r=n.data,200!==r.meta.status?e.$msg.error(r.meta.msg):(e.$msg.success("删除成功!"),e.getAttributes());case 5:case"end":return a.stop()}}),a)})))).catch((function(){e.$msg({type:"info",message:"已取消删除"})}))},saveTag:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.attr_vals.join(" "),a.next=3,Object(s["g"])(e.cateId,t.attr_id,t.attr_name,t.attr_sel,n);case 3:if(r=a.sent,i=r.data,200===i.meta.status){a.next=7;break}return a.abrupt("return",e.$msg.error(i.meta.msg));case 7:e.$msg.success("修改成功！");case 8:case"end":return a.stop()}}),a)})))()},handleInputConfirm:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==t.inputValue.length){a.next=5;break}return t.inputVisible=!1,t.inputValue="",e.$msg.error("error."),a.abrupt("return");case 5:t.attr_vals.push(t.inputValue),t.inputValue="",t.inputVisible=!1,e.saveTag(t);case 9:case"end":return a.stop()}}),a)})))()},showInput:function(t){var e=this;t.inputVisible=!0,this.$nextTick((function(){e.$refs.saveTagInput.$refs.input.focus()}))},deleteTag:function(t,e){t.attr_vals.splice(e,1),this.saveTag(t)}}},o=l,u=(a("843c"),a("2877")),c=Object(u["a"])(o,n,r,!1,null,"0183dd51",null);e["default"]=c.exports},"843c":function(t,e,a){"use strict";a("accd")},accd:function(t,e,a){}}]);
//# sourceMappingURL=chunk-73470a1d.b161cd14.js.map